{
    "name": "skalp",
    "displayName": "SKALP Language Support",
    "description": "Full-stack IDE for SKALP hardware design language â€” syntax, LSP, waveforms, schematics, equivalence checking",
    "version": "0.2.0",
    "publisher": "skalp-lang",
    "engines": {
        "vscode": "^1.74.0"
    },
    "categories": [
        "Programming Languages",
        "Visualization",
        "Testing"
    ],
    "keywords": [
        "hardware",
        "HDL",
        "SKALP",
        "FPGA",
        "ASIC",
        "synthesis",
        "HLS"
    ],
    "activationEvents": [
        "onLanguage:skalp",
        "onCommand:skalp.build",
        "onCommand:skalp.simulate",
        "onCommand:skalp.ec",
        "onCommand:skalp.synthesize",
        "onCommand:skalp.format",
        "onCommand:skalp.analyze",
        "onCommand:skalp.showWaveform",
        "onCommand:skalp.showSchematic",
        "onCommand:skalp.showExpressionViewer",
        "onCommand:skalp.newProject",
        "onCommand:skalp.genTestbench",
        "onView:skalpEc",
        "onTaskType:skalp",
        "onDebugResolve:skalp"
    ],
    "main": "./dist/extension.js",
    "contributes": {
        "languages": [
            {
                "id": "skalp",
                "aliases": [
                    "SKALP",
                    "skalp"
                ],
                "extensions": [
                    ".sk",
                    ".skalp"
                ],
                "configuration": "./language-configuration.json"
            }
        ],
        "grammars": [
            {
                "language": "skalp",
                "scopeName": "source.skalp",
                "path": "./syntaxes/skalp.tmLanguage.json"
            }
        ],
        "commands": [
            {
                "command": "skalp.build",
                "title": "Build",
                "category": "SKALP",
                "icon": "$(gear)"
            },
            {
                "command": "skalp.simulate",
                "title": "Simulate",
                "category": "SKALP",
                "icon": "$(play)"
            },
            {
                "command": "skalp.ec",
                "title": "Equivalence Check",
                "category": "SKALP",
                "icon": "$(verified)"
            },
            {
                "command": "skalp.showWaveform",
                "title": "Open Waveform Viewer",
                "category": "SKALP",
                "icon": "$(graph-line)"
            },
            {
                "command": "skalp.showSchematic",
                "title": "Show Schematic",
                "category": "SKALP",
                "icon": "$(circuit-board)"
            },
            {
                "command": "skalp.synthesize",
                "title": "Synthesize",
                "category": "SKALP",
                "icon": "$(chip)"
            },
            {
                "command": "skalp.format",
                "title": "Format",
                "category": "SKALP",
                "icon": "$(edit)"
            },
            {
                "command": "skalp.analyze",
                "title": "Analyze",
                "category": "SKALP",
                "icon": "$(search)"
            },
            {
                "command": "skalp.showExpressionViewer",
                "title": "Expression Viewer",
                "category": "SKALP",
                "icon": "$(symbol-operator)"
            },
            {
                "command": "skalp.restart",
                "title": "Restart Language Server",
                "category": "SKALP"
            },
            {
                "command": "skalp.openTestWaveform",
                "title": "View Waveform",
                "category": "SKALP",
                "icon": "$(graph-line)"
            },
            {
                "command": "skalp.newProject",
                "title": "New Project",
                "category": "SKALP",
                "icon": "$(file-directory-create)"
            },
            {
                "command": "skalp.genTestbench",
                "title": "Generate Testbench",
                "category": "SKALP",
                "icon": "$(beaker)"
            }
        ],
        "taskDefinitions": [
            {
                "type": "skalp",
                "required": [
                    "command"
                ],
                "properties": {
                    "command": {
                        "type": "string",
                        "enum": [
                            "build",
                            "simulate",
                            "synthesize",
                            "ec",
                            "format",
                            "analyze"
                        ],
                        "description": "The SKALP command to run"
                    },
                    "file": {
                        "type": "string",
                        "description": "Source file path"
                    },
                    "target": {
                        "type": "string",
                        "enum": [
                            "sv",
                            "gates",
                            "mir"
                        ],
                        "description": "Build target"
                    },
                    "cycles": {
                        "type": "number",
                        "description": "Simulation cycles"
                    },
                    "device": {
                        "type": "string",
                        "description": "FPGA device for synthesis"
                    },
                    "optimize": {
                        "type": "string",
                        "enum": [
                            "quick",
                            "balanced",
                            "full",
                            "area",
                            "timing"
                        ],
                        "description": "Optimization preset"
                    }
                }
            }
        ],
        "problemMatchers": [
            {
                "name": "skalp",
                "owner": "skalp",
                "fileLocation": [
                    "autoDetect",
                    "${workspaceFolder}"
                ],
                "pattern": {
                    "regexp": "^(.+):(\\d+):(\\d+): (error|warning|info): (.+)$",
                    "file": 1,
                    "line": 2,
                    "column": 3,
                    "severity": 4,
                    "message": 5
                }
            }
        ],
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "skalp-explorer",
                    "title": "SKALP",
                    "icon": "$(circuit-board)"
                }
            ]
        },
        "views": {
            "skalp-explorer": [
                {
                    "id": "skalpEc",
                    "name": "Equivalence Checking",
                    "icon": "$(verified)"
                }
            ]
        },
        "menus": {
            "explorer/context": [
                {
                    "when": "resourceExtname == .sk || resourceExtname == .skalp",
                    "command": "skalp.build",
                    "group": "skalp@1"
                },
                {
                    "when": "resourceExtname == .sk || resourceExtname == .skalp",
                    "command": "skalp.simulate",
                    "group": "skalp@2"
                },
                {
                    "when": "resourceExtname == .sk || resourceExtname == .skalp",
                    "command": "skalp.synthesize",
                    "group": "skalp@3"
                },
                {
                    "when": "resourceExtname == .sk || resourceExtname == .skalp",
                    "command": "skalp.ec",
                    "group": "skalp@4"
                },
                {
                    "when": "resourceExtname == .sk || resourceExtname == .skalp",
                    "command": "skalp.format",
                    "group": "skalp@5"
                },
                {
                    "when": "resourceExtname == .sk || resourceExtname == .skalp",
                    "command": "skalp.genTestbench",
                    "group": "skalp@6"
                }
            ],
            "editor/context": [
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.build",
                    "group": "skalp@1"
                },
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.simulate",
                    "group": "skalp@2"
                },
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.synthesize",
                    "group": "skalp@3"
                },
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.ec",
                    "group": "skalp@4"
                },
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.format",
                    "group": "skalp@5"
                },
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.showSchematic",
                    "group": "skalp@6"
                },
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.showExpressionViewer",
                    "group": "skalp@7"
                },
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.genTestbench",
                    "group": "skalp@8"
                }
            ],
            "editor/title": [
                {
                    "when": "resourceLangId == skalp",
                    "command": "skalp.build",
                    "group": "navigation"
                }
            ],
            "testing/item/context": [
                {
                    "command": "skalp.openTestWaveform",
                    "group": "inline",
                    "when": "testId in skalp.testsWithWaveforms"
                }
            ]
        },
        "keybindings": [
            {
                "command": "skalp.build",
                "key": "ctrl+shift+b",
                "mac": "cmd+shift+b",
                "when": "resourceLangId == skalp"
            },
            {
                "command": "skalp.simulate",
                "key": "ctrl+shift+s",
                "mac": "cmd+shift+s",
                "when": "resourceLangId == skalp"
            },
            {
                "command": "skalp.ec",
                "key": "ctrl+shift+e",
                "mac": "cmd+shift+e",
                "when": "resourceLangId == skalp"
            },
            {
                "command": "skalp.showExpressionViewer",
                "key": "ctrl+shift+x",
                "mac": "cmd+shift+x",
                "when": "resourceLangId == skalp"
            }
        ],
        "customEditors": [
            {
                "viewType": "skalp.waveformViewer",
                "displayName": "SKALP Waveform Viewer",
                "selector": [
                    {
                        "filenamePattern": "*.skw"
                    },
                    {
                        "filenamePattern": "*.skw.gz"
                    }
                ],
                "priority": "default"
            }
        ],
        "debuggers": [
            {
                "type": "skalp",
                "label": "SKALP Debug",
                "languages": ["skalp"],
                "configurationAttributes": {
                    "launch": {
                        "required": ["program"],
                        "properties": {
                            "program": {
                                "type": "string",
                                "description": "Path to .sk file to debug"
                            },
                            "stopOnEntry": {
                                "type": "boolean",
                                "default": true,
                                "description": "Pause at cycle 0 after loading"
                            },
                            "level": {
                                "type": "string",
                                "enum": ["behavioral", "gate"],
                                "default": "behavioral",
                                "description": "Simulation level"
                            },
                            "maxCycles": {
                                "type": "number",
                                "default": 100000,
                                "description": "Maximum simulation cycles before auto-stop"
                            },
                            "topModule": {
                                "type": "string",
                                "description": "Top-level module name (auto-detected if omitted)"
                            }
                        }
                    }
                },
                "initialConfigurations": [
                    {
                        "name": "Debug SKALP",
                        "type": "skalp",
                        "request": "launch",
                        "program": "${file}",
                        "stopOnEntry": true
                    }
                ],
                "configurationSnippets": [
                    {
                        "label": "SKALP: Debug Design",
                        "description": "Debug a SKALP hardware design with interactive simulation",
                        "body": {
                            "name": "Debug SKALP",
                            "type": "skalp",
                            "request": "launch",
                            "program": "^\"${file}\"",
                            "stopOnEntry": true
                        }
                    }
                ]
            }
        ],
        "breakpoints": [
            {
                "language": "skalp"
            }
        ],
        "configuration": {
            "type": "object",
            "title": "SKALP",
            "properties": {
                "skalp.serverPath": {
                    "type": "string",
                    "default": "skalp-lsp",
                    "description": "Path to the SKALP language server executable"
                },
                "skalp.cliPath": {
                    "type": "string",
                    "default": "skalp",
                    "description": "Path to the SKALP CLI executable"
                },
                "skalp.trace.server": {
                    "type": "string",
                    "enum": [
                        "off",
                        "messages",
                        "verbose"
                    ],
                    "default": "off",
                    "description": "Traces the communication between VS Code and the SKALP language server"
                },
                "skalp.buildOnSave": {
                    "type": "boolean",
                    "default": false,
                    "description": "Automatically build on file save"
                },
                "skalp.simulation.defaultCycles": {
                    "type": "number",
                    "default": 1000,
                    "description": "Default number of simulation cycles"
                },
                "skalp.waveform.defaultRadix": {
                    "type": "string",
                    "enum": [
                        "hex",
                        "binary",
                        "decimal",
                        "signed",
                        "float"
                    ],
                    "default": "hex",
                    "description": "Default radix for waveform display"
                },
                "skalp.waveform.fontSize": {
                    "type": "number",
                    "default": 12,
                    "minimum": 8,
                    "maximum": 24,
                    "description": "Font size (px) for waveform viewer signal names and values. Increase for HiDPI displays."
                },
                "skalp.ec.outputDir": {
                    "type": "string",
                    "default": "",
                    "description": "Directory for equivalence checking output (defaults to workspace)"
                }
            }
        }
    },
    "scripts": {
        "vscode:prepublish": "npm run package",
        "compile": "node esbuild.js",
        "watch": "node esbuild.js --watch",
        "package": "node esbuild.js --production",
        "compile:tsc": "tsc -p ./ --noEmit"
    },
    "dependencies": {
        "@vscode/debugadapter": "^1.65.0",
        "@vscode/debugprotocol": "^1.65.0",
        "elkjs": "^0.11.0",
        "vscode-languageclient": "^8.0.0"
    },
    "devDependencies": {
        "@types/node": "^18.0.0",
        "@types/vscode": "^1.74.0",
        "esbuild": "^0.20.0",
        "typescript": "^4.9.0"
    }
}
