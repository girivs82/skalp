// Test fixture for quadratic formula using fp32
// Tests: x = (-b + sqrt(b^2 - 4ac)) / (2a)

use skalp::numeric::fp::*;
use skalp::numeric::cordic::CordicSqrt;

entity FpQuadratic {
    in a: fp32
    in b: fp32
    in c: fp32
    out discriminant: fp32
    out x1: fp32
}

impl FpQuadratic {
    // b^2 - 4ac
    signal b_squared: fp32 = b * b
    signal four_ac: fp32 = 4.0fp32 * a * c
    discriminant = b_squared - four_ac

    // Directly instantiate CordicSqrt entity
    signal sqrt_disc: fp32
    let sqrt_op = CordicSqrt {
        value: discriminant,
        result: sqrt_disc
    }

    // (-b + sqrt(discriminant)) / (2a)
    signal neg_b: fp32 = -b
    signal numerator: fp32 = neg_b + sqrt_disc
    signal two_a: fp32 = 2.0fp32 * a
    x1 = numerator / two_a
}
